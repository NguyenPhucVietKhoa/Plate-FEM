function[N,derN] = Shape_function_K(xi, eta,lex,ley)

N1e = -((xi-1)*(eta-1)*(xi^2+xi+eta^2+eta-2))/8;
N2e = -ley*((xi-1)*(eta-1)^2*(eta+1))/16;
N3e = lex*((xi-1)^2*(xi+1)*(eta-1))/16;

N4e = ((xi+1)*(eta-1)*(xi^2-xi+eta^2+eta-2))/8;
N5e = ley*((xi+1)*(eta-1)^2*(eta+1))/16;
N6e = lex*((xi-1)*(xi+1)^2*(eta-1))/16;

N7e = ((xi+1)*(eta+1)*(-xi^2+xi-eta^2+eta+2))/8;
N8e = ley*((xi+1)*(eta-1)*(eta+1)^2)/16;
N9e = -lex*((xi-1)*(xi+1)^2*(eta+1))/16;

N10e = ((xi-1)*(eta+1)*(xi^2+xi+eta^2-eta-2))/8;
N11e = -ley*((xi-1)*(eta-1)*(eta+1)^2)/16;
N12e = -lex*((xi-1)^2*(xi+1)*(eta+1))/16;

N = [N1e N2e N3e N4e N5e N6e N7e N8e N9e N10e N11e N12e];

derN(1,:) = [-((eta-1)*(eta^2+eta+3*xi^2-3))/8 ...
            -ley*((eta-1)^2*(eta+1))/16 ...
            lex*((eta-1)*(3*xi^2-2*xi-1))/16 ...
            ((eta-1)*(eta^2+eta+3*xi^2-3))/8 ...
            ley*((eta-1)^2*(eta+1))/16 ...
            lex*((eta-1)*(3*xi^2+2*xi-1))/16 ...
            ((eta+1)*(-eta^2+eta-3*xi^2+3))/8 ...
            ley*((eta-1)*(eta+1)^2)/16 ...
            -lex*((eta+1)*(3*xi^2+2*xi-1))/16 ...
            ((eta+1)*(eta^2-eta+3*xi^2-3))/8 ...
            -ley*((eta-1)*(eta+1)^2)/16 ...
            -lex*((eta+1)*(3*xi^2-2*xi-1))/16];

derN(2,:) = [-((xi-1)*(xi^2+xi+3*eta^2-3))/8 ...
            -ley*((xi-1)*(3*eta^2-2*eta-1))/16 ...
            lex*((xi-1)^2*(xi+1))/16 ...
            ((xi+1)*(xi^2-xi+3*eta^2-3))/8 ...
            ley*((xi+1)*(3*eta^2-2*eta-1))/16 ...
            lex*((xi-1)*(xi+1)^2)/16 ...
            ((xi+1)*(-xi^2+xi-3*eta^2+3))/8 ...
            ley*((xi+1)*(3*eta^2+2*eta-1))/16 ...
            -lex*((xi+1)^2*(xi-1))/16 ...
            ((xi-1)*(xi^2+xi+3*eta^2-3))/8 ...
            -ley*((xi-1)*(3*eta^2+2*eta-1))/16 ...
            -lex*((xi-1)^2*(xi+1))/16];

derN(3,:) = [-(3*xi*(eta-1))/4 ...
             0 ...
             lex*((3*xi-1)*(eta-1))/8 ...
             (3*xi*(eta-1))/4 ...
             0 ...
             lex*((3*xi+1)*(eta-1))/8 ...
             -(3*xi*(eta+1))/4 ...
             0 ...
             -lex*((3*xi+1)*(eta+1))/8 ...
             (3*xi*(eta+1))/4 ...
             0 ...
             -lex*((3*xi-1)*(eta+1))/8];

derN(4,:) = [-(3*eta*(xi-1))/4 ...
             -ley*((3*eta-1)*(xi-1))/8 ...
             0 ...
             (3*eta*(xi+1))/4 ...
             ley*((3*eta-1)*(xi+1))/8 ...
             0 ...
             -(3*eta*(xi+1))/4 ...
             ley*((3*eta+1)*(xi+1))/8 ...
             0 ...
             (3*eta*(xi-1))/4 ...
             -ley*((3*eta+1)*(xi-1))/8 ...
             0];

derN(5,:) = [-(3*xi^2+3*eta^2-4)/8 ...
             -ley*(3*eta^2-2*eta-1)/16 ...
             lex*(3*xi^2-2*xi-1)/16 ...
             (3*xi^2+3*eta^2-4)/8 ...
             ley*(3*eta^2-2*eta-1)/16 ...
             lex*(3*xi^2+2*xi-1)/16 ...
             (-3*xi^2-3*eta^2+4)/8 ...
             ley*(3*eta^2+2*eta-1)/16 ...
             -lex*(3*xi^2+2*xi-1)/16 ...
             (3*xi^2+3*eta^2-4)/8 ...
             -ley*(3*eta^2+2*eta-1)/16 ...
             -lex*(3*xi^2-2*xi-1)/16];

end